@page "/statistics/{id}"
@using Unmatched.Services
@using Unmatched.Dtos
@inject IUnmatchedService UnmatchedService

<h3 align="center">@Hero.HeroName</h3>
<img   src="@imageSource" />
<h4>Total Matches: @Hero.TotalMatches</h4>
<h4>Total Wins: @Hero.TotalWins</h4>
<h4>Total Looses: @Hero.TotalLooses</h4>
<h4> Matches: </h4>
<DuelMatches matchLogEntries="matchLogEntries"></DuelMatches>

@code {
    [Parameter]
    public string id { get; set; }
    
    private IEnumerable<MatchLogDto> matchLogEntries;

    public HeroStatisticsDto Hero { get; set; } = new ();

    private string? imageSource;
    
    protected override async Task OnInitializedAsync()
    {
        var heroId = Guid.Parse(id);
        Hero = await UnmatchedService.GetStatisticsByHeroIdAsync(heroId);
        matchLogEntries = (await UnmatchedService.GetHeroMatchesAsync(heroId)).OrderByDescending(x => x.Date).ToArray();
        foreach (var matchLogEntry in matchLogEntries)
        {
            matchLogEntry.Fighters = matchLogEntry.Fighters.OrderByDescending(x => x.HeroId == heroId);
        }
        imageSource = $"/{Hero.HeroName}.png";
    }
}